
CREATE VIEW [DBA].[view_script_copy_permissions]
AS
SELECT
	A.[permission_name] AS 'Permission'
	,A.[state_desc] AS 'Action'
	,CONCAT('[', C.[name], + '].[', B.[name], ']') AS 'SourceObject'
	,CONCAT('[', D.[name], ']') AS 'PrincipalName'
	,CONCAT( A.[state_desc], ' ', A.[permission_name], ' ON @DestinationObject TO [', D.name,  ']') COLLATE SQL_Latin1_General_CP1_CI_AS AS 'TSQL'

FROM sys.database_permissions A
INNER JOIN sys.objects B
	ON B.object_id = A.major_id
INNER JOIN sys.schemas C
	ON C.schema_id = B.schema_id
INNER JOIN sys.database_principals D
	ON A.grantee_principal_id = D.principal_id
WHERE
	A.permission_name = 'SELECT'
	AND A.class = 1
GO
